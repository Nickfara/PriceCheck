#:set btn "#002538"
#:set mainBgClr "#f0faff"
#:set topBgClr "#c9e5ff"

<Main>:
    MDScreen:
        MDBoxLayout:
            md_bg_color: mainBgClr
            orientation: 'vertical'
            MDBoxLayout:
                id: topLay
                orientation: 'horizontal'
                size_hint_y: None
                height: "60dp"
                md_bg_color: topBgClr

                MDBoxLayout:
                    orientation: 'vertical'
                    padding: (50, 0, 50, 0)
                    MDTextField:
                        id: text_find
                        hint_text: "Найти товары"
                        pos_hint: {'center_x': .5, 'center_y': .5}
                        text_color_focus: "black"
                        text: ""
                        focus: True
                        MDTextFieldLeadingIcon:
                            icon: "magnify"
                MDBoxLayout:
                    orientation: 'horizontal'
                    MDIconButton:
                        on_release: root.settings_open()
                        icon: "cog"
                        icon_color: btn
                        line_color: btn
                    MDIconButton:
                        on_release: root.cart_open()
                        icon: "cart"
                        icon_color: btn
                        line_color: btn
                    MDIconButton:
                        on_release: root.find()
                        icon: "store-search"
                        icon_color: btn
                        line_color: btn
            MDBoxLayout:
                orientation: 'vertical'
                padding: (50, 0, 50, 0)
                ScrollView:
                    do_scroll_x: False
                    MDBoxLayout:
                        id: list_items_obj
                        orientation: 'vertical'
                        spacing: 80
                        md_bg_color: 'gray'
                        adaptive_height: True
                        size_hint_y: None


<SettingsMain@MDDialog>:
    id: dialog
    size_hint_y: None
    height: min(root.height, dp(600))
    type: "custom"
    radius: [12, 12, 12, 12]

    MDBoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(12)

        MDLabel:
            text: "Настройки"
            font_style: "H6"
            halign: "center"
            size_hint_y: None
            height: self.texture_size[1]

        ScrollView:
            MDList:
                OneLineAvatarIconListItem:
                    text: "Обновить магазины"
                    on_release: root.refresh(root)
                    IconLeftWidget:
                        icon: "refresh"

                OneLineAvatarIconListItem:
                    text: "METRO парсинг"
                    IconLeftWidget:
                        icon: "factory"
                    RightCheckbox:
                        id: checkbox_parser_metro
                        active: False

                MDSeparator:
                    height: dp(1)

                # Заголовок для таблицы
                MDLabel:
                    text: "Параметры магазина:"
                    theme_text_color: "Secondary"
                    size_hint_y: None
                    height: self.texture_size[1]

                # Подписи к столбцам (можно адаптировать под реальные поля)
                MDBoxLayout:
                    orientation: "horizontal"
                    size_hint_y: None
                    height: dp(30)

                    MDLabel:
                        text: "Имя файла"
                    MDLabel:
                        text: "Название"
                    MDLabel:
                        text: "Цена"
                    MDLabel:
                        text: "Тип"
                    MDLabel:
                        text: "Поставщик"
                    MDLabel:
                        text: "Горизонталь"
                    MDLabel:
                        text: "Вертикаль"
                    MDLabel:
                        text: "Поиск"

                # Контейнер под элементы магазина
                MDBoxLayout:
                    id: main
                    orientation: "vertical"
                    adaptive_height: True
                    spacing: dp(6)

        # Кнопки снизу
        MDBoxLayout:
            spacing: dp(10)
            padding: dp(10), 0
            size_hint_y: None
            height: dp(48)

            MDIconButton:
                icon: "plus"
                on_release: root.add_shop(app.MainApp)

            MDBoxLayout:
                size_hint_x: 0.6

            MDIconButton:
                icon: "close"
                icon_color: "red"
                on_release: root.exit_settings(app.MainApp)

            MDIconButton:
                icon: "check"
                icon_color: "green"
                on_release: root.save_settings(app.MainApp)

<SettingShop>:
    id: shop
    file_name: '12'
    title: ''
    price: ''
    supplier: ''

    MDBoxLayout:
        orientation: 'horizontal'
        spacing: dp(8)
        padding: dp(8)
        size_hint_y: None
        height: dp(56)
        md_bg_color: [1, 1, 1, 0.04]

        ScrollView:
            do_scroll_x: True
            bar_width: dp(2)

            MDBoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: self.minimum_width
                spacing: dp(12)

                MDLabel:
                    text: root.file_name
                    size_hint_x: None
                    width: self.texture_size[0]
                    theme_text_color: "Primary"

                MDLabel:
                    text: root.title
                    size_hint_x: None
                    width: self.texture_size[0]
                    theme_text_color: "Primary"

                MDLabel:
                    text: root.price
                    size_hint_x: None
                    width: self.texture_size[0]
                    theme_text_color: "Primary"

                MDLabel:
                    text: root.supplier
                    size_hint_x: None
                    width: self.texture_size[0]
                    theme_text_color: "Primary"



<CartMain@MDDialog>:
    id: cart_main
    size_hint_y: None
    height: dp(300) #min(root.height, dp(600))
    type: "custom"
    radius: [12, 12, 12, 12]

    MDBoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(12)

        MDLabel:
            text: "Корзина"
            font: "H5"
            halign: "center"
            size_hint_y: None
            height: self.texture_size[1]

        ScrollView:
            MDBoxLayout:
                id: cart_items_box
                orientation: "vertical"
                size_hint_y: None
                height: self.minimum_height
                spacing: dp(8)

        MDButtonText:
            text: "Оформить заказ"
            pos_hint: {"center_x": 0.5}
            #on_release: root.confirm_checkout()

<CartShop@MDCard>:
    orientation: "vertical"
    padding: dp(10)
    size_hint_y: None
    height: self.minimum_height
    #md_bg_color: app.theme_cls.bg_light

    MDLabel:
        id: CartName
        text: "Магазин"
        #font_style: "Subtitle1"
        size_hint_y: None
        height: self.texture_size[1]

    ScrollView:
        do_scroll_x: False
        MDList:
            id: listItems


<CartItem@MDBoxLayout>:
    orientation: 'horizontal'
    size_hint_y: None
    height: "60dp"
    spacing: "8dp"
    padding: "8dp"

    MDTextField:
        id: name_field
        text: "" #root.item_name
        hint_text: "Название"
        #mode: "rectangle"
        size_hint_x: .55
        multiline: False
        on_text_validate: root.update_name(self.text)

    MDTextField:
        id: qty_field
        text: "1" #str(root.item_quantity)
        hint_text: "Кол-во"
        #mode: "rectangle"
        size_hint_x: .25
        #input_filter: 'int'
        multiline: False
        on_text_validate: root.update_quantity(self.text)

    MDIconButton:
        id: buttonItem
        icon: "delete"
        icon_color: "red"
        on_release: root.remove_self()

<ItemObj>
    MDListItem:
        id: item_object
        orientation: 'horizontal'
        size_hint_y: None
        height: '80dp'

        MDListItemSupportingText:
            id: item_seller
            allow_selection: True
            allow_copy: True
        MDListItemHeadlineText:
            id: item_name
            allow_selection: True
            allow_copy: True
        MDListItemTertiaryText:
            id: item_cost
            allow_selection: True
            allow_copy: True
        MDIconButton:
            id: idItem
            icon_color: 'white'
            line_color: 'white'

<Plain>
    MDTooltipPlain:
        id: plain
        text: ''